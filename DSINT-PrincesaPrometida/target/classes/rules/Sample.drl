package com.sample
 
import com.sample.DroolsTest.Message;
import animales.*;
import lugares.*;
import personajes.*;
import relaciones.*;
import utilidades.*;
import java.util.*;



rule "Añadir Lugar a Weatley"
    when
    	p : Personaje(nombre == "Weasley", ubicacionActual == null, estadoSalud == EstadoSalud.VIVO)
    	l : Lugar(nombre == "Granja")
    then
        modify(p){
			setUbicacionActual(l);
		}
		System.out.println("Se ha actualizado Ubicacion de: "+ p.getNombre() +" a " + l.getNombre());
end

rule "Añadir Lugar a Buttercup"
    when
    	p : Personaje(nombre == "Buttercup", ubicacionActual == null, estadoSalud == EstadoSalud.VIVO)
    	l : Lugar(nombre == "Granja")
    then
        modify(p){
			setUbicacionActual(l);
		}
		System.out.println("Se ha actualizado Ubicacion de: "+ p.getNombre() +" a " + l.getNombre());
end


rule "Relacion Conocer"
    when
        p1 : Personaje(ubicacionActual != null)
        p2 : Personaje(ubicacionActual == p1.getUbicacionActual(), nombre != p1.getNombre())
    then
    	System.out.println("Modifico: "+ p1.getNombre() + " y " + p2.getNombre());

        Relacion r = new ConoceA(p2);
        Relacion r2 = new ConocidoDe(p1);
        ArrayList<Relacion> listaR1 = p1.getRelacionesPersonaje();
        listaR1.add(r);
        //listaR1.add(r2);
        modify(p1){
        	setRelacionesPersonaje(listaR1);
        }
        
        //Relacion r3 = new ConoceA(p1);
        //Relacion r4 = new ConocidoDe(p1);
        ArrayList<Relacion> listaR2 = p2.getRelacionesPersonaje();
        listaR2.add(r2);
        //listaR2.add(r4);
        modify(p2){
        	setRelacionesPersonaje(listaR2);
        }
        
        
        System.out.println("Relaciones de: " + p1.getNombre() + " = " + p1.getRelacionesPersonaje().toString());
        System.out.println("Relaciones de: " + p2.getNombre() + " = " + p2.getRelacionesPersonaje().toString());
     
end
